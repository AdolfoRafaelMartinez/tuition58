<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalshi Trade Bot</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container" data-balance="<%= kalshi ? kalshi.balance : 0 %>">
        <h1>Tuition Bot</h1>
        <div id="clock"></div>
        <div class="section">
            <h2>Forecast</h2>
            <% if (weather) { %>
                <p><strong><%= weather.name %>:</strong> <%= weather.temperature %>Â°<%= weather.temperatureUnit %></p>
                <p><strong>Start Time:</strong> <%= new Date(weather.startTime).toLocaleString() %></p>
            <% } else { %>
                <p>Weather data not available.</p>
            <% } %>
        </div>
        <div class="section">
            <h2>Observed</h2>
            <% if (observed && observed.observation_max) { %>
                <p><%= observed.observation_max %> at <%= observed.observation_when %></p>
                <p>Reported at <%= observed.report_when %></p>
            <% } else if (observed && observed.error) { %>
                <p><%= observed.error %></p>
            <% } else { %>
                <p>Maximum temperature data not available.</p>
            <% } %>
        </div>
        <div class="section">
            <h2>Kalshi</h2>
            <% if (kalshi) { %>
                <p><strong>Balance:</strong> $<%= (kalshi.balance / 100).toFixed(2) %></p>
            <% } else { %>
                <p>Kalshi data not available.</p>
            <% } %>
        </div>
        <div class="section">
            <h2>Get Open Markets</h2>
            <form id="market-form">
                <label for="event-ticker">Event Ticker:</label>
                <input type="text" id="event-ticker" name="event-ticker" value="KXHIGHAUS-26JAN26" required>
                <button type="submit">Get Markets</button>
            </form>
            <div id="market-result"></div>
        </div>
        <div class="section">
            <h2>Place Orders</h2>
            <form id="combined-order-form">
                <div class="order-section">
                    <h3>Order 1</h3>
                    <label for="ticker">Ticker:</label>
                    <input type="text" id="ticker" name="ticker" required>
                    <label for="action">Action:</label>
                    <select id="action" name="action">
                        <option value="buy">Buy</option>
                        <option value="sell">Sell</option>
                    </select>
                    <label for="side">Side:</label>
                    <select id="side" name="side">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                    <label for="yes_price">Yes Price (in cents):</label>
                    <input type="number" id="yes_price" name="yes_price" min="1" max="99" required>
                    <label for="count">Count:</label>
                    <input type="number" id="count" name="count" min="1" required>
                </div>
                <hr>
                <div class="order-section">
                    <h3>Order 2</h3>
                    <label for="ticker-2">Ticker:</label>
                    <input type="text" id="ticker-2" name="ticker-2">
                    <label for="action-2">Action:</label>
                    <select id="action-2" name="action-2">
                        <option value="buy">Buy</option>
                        <option value="sell">Sell</option>
                    </select>
                    <label for="side-2">Side:</label>
                    <select id="side-2" name="side-2">
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                    <label for="yes_price-2">Yes Price (in cents):</label>
                    <input type="number" id="yes_price-2" name="yes_price-2" min="1" max="99">
                    <label for="count-2">Count:</label>
                    <input type="number" id="count-2" name="count-2" min="1">
                </div>
                <button type="submit">Place Orders</button>
            </form>
            <div id="order-result"></div>
            <div id="order-result-2"></div>
        </div>
    </div>
    <script src="/js/orderForm.js"></script>
    <script src="/js/marketForm.js"></script>
    <script>
        function updateClock() {
            const now = new Date();
            const clock = document.getElementById('clock');
            clock.textContent = now.toLocaleString();
        }
        setInterval(updateClock, 1000);
        updateClock();

        function generateAndDisplayTicker() {
            const now = new Date();
            const year = now.getFullYear().toString().slice(-2);
            const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            const month = months[now.getMonth()];
            const day = String(now.getDate()).padStart(2, '0');
            const dateString = `${year}${month}${day}`;
            const ticker = `KXHIGHAUS-${dateString}`;
            const eventTickerInput = document.getElementById('event-ticker');
            if (eventTickerInput) {
                eventTickerInput.value = ticker;
            }
        }
        generateAndDisplayTicker();
    </script>
</body>
</html>